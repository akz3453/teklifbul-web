<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kategori GruplandÄ±rma Testi</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .info { background: #d1ecf1; color: #0c5460; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .badge { display:inline-block; margin:4px 6px 0 0; padding:4px 8px; border-radius:12px; background:#eef2ff; font-size:12px; cursor:pointer; }
        .group-btn { padding: 8px 12px; margin: 4px; background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; border-radius: 6px; cursor: pointer; font-size: 12px; transition: all 0.2s; }
        .group-btn:hover { background: #e5e7eb; }
        .group-btn.selected { background: #10b981; color: white; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Kategori GruplandÄ±rma Testi</h1>
    
    <div class="test-section info">
        <h3>ğŸ“‹ Test Senaryosu</h3>
        <p>Bu sayfa kategori gruplandÄ±rma Ã¶zelliÄŸinin dÃ¼zgÃ¼n Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± test eder.</p>
        <ol>
            <li>Grup butonlarÄ±na tÄ±kla ve kategorilerin eklendiÄŸini kontrol et</li>
            <li>Yeni grup oluÅŸtur</li>
            <li>Grup butonlarÄ±na saÄŸ tÄ±k yap ve dÃ¼zenle/sil</li>
            <li>Tekil kategori ekleme Ã§alÄ±ÅŸÄ±yor mu kontrol et</li>
        </ol>
    </div>
    
    <div class="test-section">
        <h3>ğŸ¯ Kategori GruplandÄ±rma Demo</h3>
        
        <!-- Kategori GruplarÄ± -->
        <div id="categoryGroups" style="margin-bottom: 16px;">
            <h4 style="margin: 8px 0; font-size: 14px; color: #374151;">ğŸ“ Kategori GruplarÄ±</h4>
            <div id="groupButtons" style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 12px;">
                <!-- Grup butonlarÄ± buraya eklenecek -->
            </div>
            <button type="button" id="createGroupBtn" style="padding: 6px 12px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
                â• Yeni Grup OluÅŸtur
            </button>
        </div>
        
        <!-- Tekil Kategori SeÃ§imi -->
        <div style="margin-bottom: 12px;">
            <h4 style="margin: 8px 0; font-size: 14px; color: #374151;">ğŸ·ï¸ Tekil Kategori SeÃ§imi</h4>
            <input id="catInput" placeholder="Kategori ara/ekle ve Enter'a bas" style="width:100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px;" />
        </div>
        
        <!-- SeÃ§ilen Kategoriler -->
        <div>
            <h4 style="margin: 8px 0; font-size: 14px; color: #374151;">âœ… SeÃ§ilen Kategoriler</h4>
            <div id="catChips"></div>
        </div>
    </div>
    
    <div class="test-section">
        <h3>ğŸ§ª Test ButonlarÄ±</h3>
        <button onclick="testGroupSelection()">Grup SeÃ§imini Test Et</button>
        <button onclick="testGroupCreation()">Grup OluÅŸturmayÄ± Test Et</button>
        <button onclick="testIndividualCategories()">Tekil Kategori Test Et</button>
        <button onclick="clearAll()">TÃ¼mÃ¼nÃ¼ Temizle</button>
    </div>
    
    <div id="test-results"></div>
    
    <script>
        // Category Groups system
        const categoryGroups = new Map(); // groupName -> Set of categories
        let currentGroupName = null;
        const chips = new Set();

        function renderChips() {
            const box = document.getElementById("catChips");
            box.innerHTML = "";
            [...chips].forEach(v => {
                const span = document.createElement("span");
                span.className = "badge";
                span.textContent = v + " âœ•";
                span.onclick = () => { chips.delete(v); renderChips(); };
                box.appendChild(span);
            });
        }

        function renderGroupButtons() {
            const container = document.getElementById("groupButtons");
            container.innerHTML = "";
            
            // VarsayÄ±lan gruplar
            const defaultGroups = [
                { name: "Ä°nÅŸaat", categories: ["Beton", "Ã‡imento", "Demir", "TuÄŸla", "Ã‡atÄ±", "Ä°zolasyon"] },
                { name: "Elektrik", categories: ["Kablo", "Elektrik Panosu", "AydÄ±nlatma", "Elektrik Malzemeleri"] },
                { name: "Makine", categories: ["Motor", "Pompa", "KompresÃ¶r", "Makine ParÃ§alarÄ±"] },
                { name: "Teknoloji", categories: ["Bilgisayar", "YazÄ±lÄ±m", "Network", "GÃ¼venlik Sistemleri"] }
            ];

            // VarsayÄ±lan gruplarÄ± ekle
            defaultGroups.forEach(group => {
                if (!categoryGroups.has(group.name)) {
                    categoryGroups.set(group.name, new Set(group.categories));
                }
            });

            // Grup butonlarÄ±nÄ± render et
            categoryGroups.forEach((categories, groupName) => {
                const button = document.createElement("button");
                button.type = "button";
                button.className = "group-btn";
                button.textContent = `${groupName} (${categories.size})`;
                button.title = `Kategoriler: ${[...categories].join(', ')}`;
                
                button.addEventListener("click", () => {
                    if (currentGroupName === groupName) {
                        // Grup seÃ§imini kaldÄ±r
                        currentGroupName = null;
                        button.classList.remove('selected');
                    } else {
                        // Grup seÃ§
                        currentGroupName = groupName;
                        // Ã–nceki seÃ§imi temizle
                        container.querySelectorAll('.group-btn').forEach(btn => {
                            btn.classList.remove('selected');
                        });
                        button.classList.add('selected');
                        
                        // Grup kategorilerini ekle
                        categories.forEach(cat => chips.add(cat));
                        renderChips();
                    }
                });
                
                // SaÄŸ tÄ±k menÃ¼sÃ¼ ekle
                button.addEventListener("contextmenu", (e) => {
                    e.preventDefault();
                    const action = confirm(`"${groupName}" grubunu dÃ¼zenlemek istiyor musunuz?\n\nTamam = DÃ¼zenle\nÄ°ptal = Sil`);
                    if (action) {
                        editGroup(groupName);
                    } else {
                        if (confirm(`"${groupName}" grubunu silmek istediÄŸinizden emin misiniz?`)) {
                            categoryGroups.delete(groupName);
                            if (currentGroupName === groupName) {
                                currentGroupName = null;
                            }
                            renderGroupButtons();
                        }
                    }
                });
                
                container.appendChild(button);
            });
        }

        function createNewGroup() {
            const groupName = prompt("Grup adÄ±nÄ± girin:");
            if (!groupName || groupName.trim() === '') return;
            
            const trimmedName = groupName.trim();
            if (categoryGroups.has(trimmedName)) {
                alert("Bu grup adÄ± zaten mevcut!");
                return;
            }
            
            // Yeni grup oluÅŸtur
            categoryGroups.set(trimmedName, new Set());
            
            // Grup dÃ¼zenleme modalÄ± aÃ§
            editGroup(trimmedName);
        }

        function editGroup(groupName) {
            const categories = categoryGroups.get(groupName);
            const currentCategories = [...categories].join(', ');
            
            const newCategories = prompt(
                `"${groupName}" grubu iÃ§in kategorileri girin (virgÃ¼lle ayÄ±rÄ±n):\n\nMevcut: ${currentCategories}`,
                currentCategories
            );
            
            if (newCategories === null) return; // Ä°ptal edildi
            
            // Kategorileri gÃ¼ncelle
            const categoryArray = newCategories.split(',').map(cat => cat.trim()).filter(cat => cat);
            categories.clear();
            categoryArray.forEach(cat => categories.add(cat));
            
            // UI'yi gÃ¼ncelle
            renderGroupButtons();
        }

        function addResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-section ${type}`;
            div.innerHTML = message;
            document.getElementById('test-results').appendChild(div);
        }

        function clearResults() {
            document.getElementById('test-results').innerHTML = '';
        }

        function testGroupSelection() {
            clearResults();
            addResult('<h3>ğŸ§ª Grup SeÃ§imi Testi</h3>', 'info');
            
            if (chips.size > 0) {
                addResult(`âœ… SeÃ§ilen kategoriler: ${[...chips].join(', ')}`, 'success');
            } else {
                addResult('âš ï¸ HenÃ¼z kategori seÃ§ilmedi', 'warning');
            }
            
            if (currentGroupName) {
                addResult(`âœ… Aktif grup: ${currentGroupName}`, 'success');
            } else {
                addResult('â„¹ï¸ Aktif grup yok', 'info');
            }
        }

        function testGroupCreation() {
            clearResults();
            addResult('<h3>ğŸ§ª Grup OluÅŸturma Testi</h3>', 'info');
            
            const groupCount = categoryGroups.size;
            addResult(`ğŸ“Š Toplam grup sayÄ±sÄ±: ${groupCount}`, 'info');
            
            categoryGroups.forEach((categories, groupName) => {
                addResult(`ğŸ“ ${groupName}: ${categories.size} kategori (${[...categories].join(', ')})`, 'info');
            });
        }

        function testIndividualCategories() {
            clearResults();
            addResult('<h3>ğŸ§ª Tekil Kategori Testi</h3>', 'info');
            
            // Test kategorisi ekle
            chips.add('Test Kategori');
            renderChips();
            addResult('âœ… Test kategorisi eklendi', 'success');
        }

        function clearAll() {
            chips.clear();
            currentGroupName = null;
            renderChips();
            renderGroupButtons();
            clearResults();
            addResult('ğŸ§¹ TÃ¼m veriler temizlendi', 'info');
        }

        // Event listeners
        document.getElementById('catInput').addEventListener('keydown', e => {
            if (e.key === 'Enter') {
                e.preventDefault();
                const v = e.target.value.trim();
                if (v) { 
                    chips.add(v); 
                    renderChips(); 
                    e.target.value = ""; 
                }
            }
        });

        document.getElementById('createGroupBtn').addEventListener('click', createNewGroup);

        // Sayfa yÃ¼klendiÄŸinde grup butonlarÄ±nÄ± render et
        renderGroupButtons();
    </script>
</body>
</html>
