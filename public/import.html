<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <title>Excelâ€™den Talep Ä°Ã§e Aktarma</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/ui-standard.css" />
</head>
<body>
  <div class="container">
    <div class="section-header"><span>ğŸ“¤</span><span>Excelâ€™den Talep Ä°Ã§e Aktarma</span></div>

    <div class="card">
      <h3>Dosya YÃ¼kle</h3>
      <input id="file" type="file" accept=".xlsx,.docx,.pdf" />
      <div class="muted small">Desteklenen formatlar: .xlsx, .docx, .pdf</div>
      <button id="btnPreview" class="btn btn-primary">Ã–nizleme</button>
    </div>

    <div id="preview" class="card" style="display:none">
      <h3>Ã–nizleme</h3>
      <div id="meta" class="muted small"></div>
      <h4 style="margin-top:8px">Talep</h4>
      <pre id="demandBox" style="white-space:pre-wrap;background:#f7f9ff;border:1px solid #e5e7eb;border-radius:8px;padding:10px"></pre>
      <h4 style="margin-top:8px">Kalemler (Kategori Ã–nerileri ile)</h4>
      <div class="muted small" style="margin-bottom:8px">
        ğŸ’¡ Her kalem iÃ§in kategori Ã¶nerileri gÃ¶sterilir. â‰¥70% gÃ¼venilirlikte otomatik seÃ§ilir. Ä°stediÄŸiniz kategorileri seÃ§ebilirsiniz.
      </div>
      <div style="max-height:400px;overflow-y:auto;border:1px solid #e5e7eb;border-radius:8px">
        <table class="table" id="itemsTable" style="margin:0"></table>
      </div>
      <div style="margin-top:10px">
        <label><input type="checkbox" id="sendNow"> OluÅŸturunca kategorilere gÃ¶re tedarikÃ§ilere gÃ¶nder</label>
      </div>
      <button id="btnCommit" class="btn btn-primary">Talebi OluÅŸtur</button>
    </div>

    <div id="result" class="card" style="display:none">
      <h3>SonuÃ§</h3>
      <pre id="resultBox" style="white-space:pre-wrap;background:#f7f9ff;border:1px solid #e5e7eb;border-radius:8px;padding:10px"></pre>
    </div>
  </div>
  <script type="module" src="/js/import.js"></script>
  <script>
    // SPA uygulamasÄ± yÃ¶nlendirmesin diye basit bir guard
    window.__IMPORT_PAGE__ = true;
  </script>
</body>
</html>


