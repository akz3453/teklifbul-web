<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rol ve Yetki Y√∂netimi - Teklifbul</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' fill='%233b82f6' rx='6'/%3E%3Ctext x='16' y='22' font-family='Arial' font-size='18' font-weight='bold' text-anchor='middle' fill='white'%3ET%3C/text%3E%3C/svg%3E" />
  <link rel="stylesheet" href="/css/ui-standard.css" />
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: #f9fafb;
      padding: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }
    .header {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin-bottom: 24px;
    }
    .header h1 {
      margin: 0 0 8px 0;
      font-size: 24px;
      color: #1f2937;
    }
    .header p {
      margin: 0;
      color: #6b7280;
      font-size: 14px;
    }
    .role-section {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin-bottom: 24px;
    }
    .role-section h2 {
      margin: 0 0 20px 0;
      font-size: 20px;
      color: #1f2937;
      padding-bottom: 12px;
      border-bottom: 2px solid #e5e7eb;
    }
    .role-card {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 16px;
      background: #f9fafb;
    }
    .role-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    .role-name {
      font-size: 18px;
      font-weight: 600;
      color: #1f2937;
    }
    .role-key {
      font-size: 12px;
      color: #6b7280;
      font-family: monospace;
      background: #e5e7eb;
      padding: 4px 8px;
      border-radius: 4px;
    }
    .permissions-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }
    .permissions-table th {
      background: #f3f4f6;
      padding: 12px;
      text-align: left;
      font-weight: 600;
      color: #374151;
      font-size: 13px;
      border-bottom: 2px solid #e5e7eb;
    }
    .permissions-table td {
      padding: 12px;
      border-bottom: 1px solid #f3f4f6;
      color: #1f2937;
    }
    .permission-status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }
    .permission-yes {
      background: #d1fae5;
      color: #065f46;
    }
    .permission-no {
      background: #fee2e2;
      color: #dc2626;
    }
    .edit-btn {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
    }
    .edit-btn:hover {
      background: #2563eb;
    }
    .save-btn {
      background: #10b981;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      margin-right: 8px;
    }
    .save-btn:hover {
      background: #059669;
    }
    .cancel-btn {
      background: #6b7280;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
    }
    .cancel-btn:hover {
      background: #4b5563;
    }
    .checkbox {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }
    .info-box {
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 24px;
    }
    .info-box p {
      margin: 0;
      color: #1e40af;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üîê Rol ve Yetki Y√∂netimi</h1>
    <p>Bu sayfada sistemdeki t√ºm alƒ±cƒ± ve tedarik√ßi rolleri ile yetkilerini g√∂r√ºnt√ºleyebilir ve d√ºzenleyebilirsiniz.</p>
  </div>

  <div class="info-box">
    <p><strong>üí° Bilgi:</strong> Bu sayfadaki deƒüi≈üiklikler doƒürudan <code>settings.html</code> dosyasƒ±ndaki <code>rolePermissions</code> objesine yansƒ±yacaktƒ±r. Deƒüi≈üiklikleri kaydettikten sonra sayfayƒ± yenileyin.</p>
  </div>

  <!-- Alƒ±cƒ± Rolleri -->
  <div class="role-section">
    <h2>üìã Alƒ±cƒ± (Buyer) Rolleri</h2>
    <div id="buyerRolesContainer"></div>
  </div>

  <!-- Tedarik√ßi Rolleri -->
  <div class="role-section">
    <h2>üì¶ Tedarik√ßi (Supplier) Rolleri</h2>
    <div id="supplierRolesContainer"></div>
  </div>

  <script type="module">
    // Teklifbul Rule v1.0 - Structured Logging
    import { logger } from './src/shared/log/logger.js';
    // Teklifbul Rule v1.0 - Toast Notification System
    import { toast } from './src/shared/ui/toast.js';
    // Teklifbul Rule v1.1 - MESSAGES constants (i18n hazƒ±rlƒ±ƒüƒ±)
    import { MESSAGES } from './src/shared/constants/messages.js';
    
    // Rol yetkileri tanƒ±mlarƒ± - Teklifbul Rol & Onay Sistemi
    // NOT: Bu sayfada yapƒ±lan deƒüi≈üiklikler settings.html dosyasƒ±ndaki rolePermissions objesine manuel olarak uygulanmalƒ±dƒ±r
    const rolePermissions = {
      // ========== ALICI (BUYER) ROLLERƒ∞ ==========
      // === Satƒ±n alma hiyerar≈üisi (e-imza onay YOK) ===
      'buyer:satinalma_uzman_yardimcisi': {
        label: 'Satƒ±n Alma Uzman Yardƒ±mcƒ±sƒ±',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': false,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true,
          'T√ºm Talepleri G√∂r√ºnt√ºleme': true,
          'Talep Atama/Delege': true,
          'Talep Tedarik√ßiye ƒ∞letme': true,
          'Mukayese G√∂r√ºnt√ºleme': true,
          'Teklif Onay (ƒ∞mza)': false,
          'Islak ƒ∞mza Y√ºkleme': true,
          'Onay Politikasƒ± Y√∂netimi': false,
          'Onay Limiti Y√∂netimi': false,
          'Onay Yetkilisi Atama': false
        }
      },
      'buyer:satinalma_uzmani': {
        label: 'Satƒ±n Alma Uzmanƒ±',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': false,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true,
          'T√ºm Talepleri G√∂r√ºnt√ºleme': true,
          'Talep Atama/Delege': true,
          'Talep Tedarik√ßiye ƒ∞letme': true,
          'Mukayese G√∂r√ºnt√ºleme': true,
          'Teklif Onay (ƒ∞mza)': false,
          'Islak ƒ∞mza Y√ºkleme': true,
          'Onay Politikasƒ± Y√∂netimi': false,
          'Onay Limiti Y√∂netimi': false,
          'Onay Yetkilisi Atama': false
        }
      },
      'buyer:satinalma_yetkilisi': {
        label: 'Satƒ±n Alma Yetkilisi',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': false,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true,
          'T√ºm Talepleri G√∂r√ºnt√ºleme': true,
          'Talep Atama/Delege': true,
          'Talep Tedarik√ßiye ƒ∞letme': true,
          'Mukayese G√∂r√ºnt√ºleme': true,
          'Teklif Onay (ƒ∞mza)': false,
          'Islak ƒ∞mza Y√ºkleme': true,
          'Onay Politikasƒ± Y√∂netimi': false,
          'Onay Limiti Y√∂netimi': false,
          'Onay Yetkilisi Atama': false
        }
      },
      'buyer:satinalma_muduru': {
        label: 'Satƒ±n Alma M√ºd√ºr√º',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': false,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true,
          'T√ºm Talepleri G√∂r√ºnt√ºleme': true,
          'Talep Atama/Delege': true,
          'Talep Tedarik√ßiye ƒ∞letme': true,
          'Mukayese G√∂r√ºnt√ºleme': true,
          'Teklif Onay (ƒ∞mza)': false,
          'Islak ƒ∞mza Y√ºkleme': true,
          'Onay Politikasƒ± Y√∂netimi': false,
          'Onay Limiti Y√∂netimi': false,
          'Onay Yetkilisi Atama': false
        }
      },
      // === √úst y√∂netim (e-imza onay VAR) ===
      'buyer:genel_mudur': {
        label: 'Genel M√ºd√ºr',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true,
          'T√ºm Talepleri G√∂r√ºnt√ºleme': true,
          'Talep Atama/Delege': true,
          'Talep Tedarik√ßiye ƒ∞letme': true,
          'Mukayese G√∂r√ºnt√ºleme': true,
          'Teklif Onay (ƒ∞mza)': true,
          'Islak ƒ∞mza Y√ºkleme': true,
          'Onay Politikasƒ± Y√∂netimi': true,
          'Onay Limiti Y√∂netimi': true,
          'Onay Yetkilisi Atama': true
        }
      },
      'buyer:genel_mudur_yardimcisi': {
        label: 'Genel M√ºd√ºr Yardƒ±mcƒ±sƒ±',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': false,
          'T√ºm Talepleri G√∂r√ºnt√ºleme': true,
          'Talep Atama/Delege': true,
          'Talep Tedarik√ßiye ƒ∞letme': true,
          'Mukayese G√∂r√ºnt√ºleme': true,
          'Teklif Onay (ƒ∞mza)': true,
          'Islak ƒ∞mza Y√ºkleme': true,
          'Onay Politikasƒ± Y√∂netimi': false,
          'Onay Limiti Y√∂netimi': false,
          'Onay Yetkilisi Atama': false
        }
      },
      'buyer:ceo': {
        label: 'CEO',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true,
          'T√ºm Talepleri G√∂r√ºnt√ºleme': true,
          'Talep Atama/Delege': true,
          'Talep Tedarik√ßiye ƒ∞letme': true,
          'Mukayese G√∂r√ºnt√ºleme': true,
          'Teklif Onay (ƒ∞mza)': true,
          'Islak ƒ∞mza Y√ºkleme': true,
          'Onay Politikasƒ± Y√∂netimi': true,
          'Onay Limiti Y√∂netimi': true,
          'Onay Yetkilisi Atama': true
        }
      },
      'buyer:isveren': {
        label: 'ƒ∞≈üveren (≈ûirket Sahibi)',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true,
          'T√ºm Talepleri G√∂r√ºnt√ºleme': true,
          'Talep Atama/Delege': true,
          'Talep Tedarik√ßiye ƒ∞letme': true,
          'Mukayese G√∂r√ºnt√ºleme': true,
          'Teklif Onay (ƒ∞mza)': true,
          'Islak ƒ∞mza Y√ºkleme': true,
          'Onay Politikasƒ± Y√∂netimi': true,
          'Onay Limiti Y√∂netimi': true,
          'Onay Yetkilisi Atama': true
        }
      },
      'buyer:yonetim_kurulu_baskani': {
        label: 'Y√∂netim Kurulu Ba≈ükanƒ±',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true,
          'T√ºm Talepleri G√∂r√ºnt√ºleme': true,
          'Talep Atama/Delege': true,
          'Talep Tedarik√ßiye ƒ∞letme': true,
          'Mukayese G√∂r√ºnt√ºleme': true,
          'Teklif Onay (ƒ∞mza)': true,
          'Islak ƒ∞mza Y√ºkleme': true,
          'Onay Politikasƒ± Y√∂netimi': true,
          'Onay Limiti Y√∂netimi': true,
          'Onay Yetkilisi Atama': true
        }
      },
      'buyer:yonetim_kurulu_uyesi': {
        label: 'Y√∂netim Kurulu √úyesi',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': false,
          'T√ºm Talepleri G√∂r√ºnt√ºleme': true,
          'Talep Atama/Delege': true,
          'Talep Tedarik√ßiye ƒ∞letme': true,
          'Mukayese G√∂r√ºnt√ºleme': true,
          'Teklif Onay (ƒ∞mza)': true,
          'Islak ƒ∞mza Y√ºkleme': true,
          'Onay Politikasƒ± Y√∂netimi': true,
          'Onay Limiti Y√∂netimi': true,
          'Onay Yetkilisi Atama': true
        }
      },
      'buyer:proje_yoneticisi': {
        label: 'Proje Y√∂neticisi',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': false,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': false,
          '≈ûirket Bilgileri D√ºzenleme': false,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'buyer:santiye_yetkilisi': {
        label: '≈ûantiye Yetkilisi',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': false,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': false,
          '≈ûirket Bilgileri D√ºzenleme': false,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'buyer:stok_depo': {
        label: 'Stok / Depo Yetkilisi',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': false,
          'Teklif G√∂r√ºnt√ºleme': false,
          'Teklif Onaylama': false,
          '≈ûirket Bilgileri D√ºzenleme': false,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'buyer:muhasebe': {
        label: 'Muhasebe',
        permissions: {
          'Talep Olu≈üturma': false,
          'Talep D√ºzenleme': false,
          'Talep Silme': false,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': false,
          '≈ûirket Bilgileri D√ºzenleme': false,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'buyer:alici': {
        label: 'Alƒ±cƒ±',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': false,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': false,
          '≈ûirket Bilgileri D√ºzenleme': false,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'buyer:genel_mudur_yardimcisi': {
        label: 'Genel M√ºd√ºr Yardƒ±mcƒ±sƒ±',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'buyer:yonetim_kurulu_baskani': {
        label: 'Y√∂netim Kurulu Ba≈ükanƒ±',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true
        }
      },
      'buyer:isveren': {
        label: 'ƒ∞≈üveren (≈ûirket Sahibi)',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true
        }
      },
      'buyer:ceo': {
        label: 'CEO',
        permissions: {
          'Talep Olu≈üturma': true,
          'Talep D√ºzenleme': true,
          'Talep Silme': true,
          'Teklif G√∂r√ºnt√ºleme': true,
          'Teklif Onaylama': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true
        }
      },
      
      // ========== TEDARƒ∞K√áƒ∞ (SUPPLIER) ROLLERƒ∞ ==========
      'supplier:satici': {
        label: 'Satƒ±cƒ±',
        permissions: {
          'Teklif Verme': true,
          'Teklif D√ºzenleme': true,
          'Teklif Silme': false,
          'Talep G√∂r√ºnt√ºleme': true,
          'Talep Detay G√∂r√ºnt√ºleme': true,
          '≈ûirket Bilgileri D√ºzenleme': false,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'supplier:satis_muduru': {
        label: 'Satƒ±≈ü M√ºd√ºr√º',
        permissions: {
          'Teklif Verme': true,
          'Teklif D√ºzenleme': true,
          'Teklif Silme': true,
          'Talep G√∂r√ºnt√ºleme': true,
          'Talep Detay G√∂r√ºnt√ºleme': true,
          '≈ûirket Bilgileri D√ºzenleme': false,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'supplier:satis_yoneticisi': {
        label: 'Satƒ±≈ü Y√∂neticisi',
        permissions: {
          'Teklif Verme': true,
          'Teklif D√ºzenleme': true,
          'Teklif Silme': true,
          'Talep G√∂r√ºnt√ºleme': true,
          'Talep Detay G√∂r√ºnt√ºleme': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'supplier:genel_mudur': {
        label: 'Genel M√ºd√ºr',
        permissions: {
          'Teklif Verme': true,
          'Teklif D√ºzenleme': true,
          'Teklif Silme': true,
          'Talep G√∂r√ºnt√ºleme': true,
          'Talep Detay G√∂r√ºnt√ºleme': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true
        }
      },
      'supplier:satis_personeli': {
        label: 'Satƒ±≈ü Personeli',
        permissions: {
          'Teklif Verme': true,
          'Teklif D√ºzenleme': true,
          'Teklif Silme': false,
          'Talep G√∂r√ºnt√ºleme': true,
          'Talep Detay G√∂r√ºnt√ºleme': true,
          '≈ûirket Bilgileri D√ºzenleme': false,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'supplier:pazarlama_muduru': {
        label: 'Pazarlama M√ºd√ºr√º',
        permissions: {
          'Teklif Verme': true,
          'Teklif D√ºzenleme': true,
          'Teklif Silme': true,
          'Talep G√∂r√ºnt√ºleme': true,
          'Talep Detay G√∂r√ºnt√ºleme': true,
          '≈ûirket Bilgileri D√ºzenleme': false,
          'Kullanƒ±cƒ± Y√∂netimi': false
        }
      },
      'supplier:yonetim_kurulu_baskani': {
        label: 'Y√∂netim Kurulu Ba≈ükanƒ±',
        permissions: {
          'Teklif Verme': true,
          'Teklif D√ºzenleme': true,
          'Teklif Silme': true,
          'Talep G√∂r√ºnt√ºleme': true,
          'Talep Detay G√∂r√ºnt√ºleme': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true
        }
      },
      'supplier:ceo': {
        label: 'CEO',
        permissions: {
          'Teklif Verme': true,
          'Teklif D√ºzenleme': true,
          'Teklif Silme': true,
          'Talep G√∂r√ºnt√ºleme': true,
          'Talep Detay G√∂r√ºnt√ºleme': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true
        }
      },
      'supplier:sirket_sahibi': {
        label: '≈ûirket Sahibi',
        permissions: {
          'Teklif Verme': true,
          'Teklif D√ºzenleme': true,
          'Teklif Silme': true,
          'Talep G√∂r√ºnt√ºleme': true,
          'Talep Detay G√∂r√ºnt√ºleme': true,
          '≈ûirket Bilgileri D√ºzenleme': true,
          'Kullanƒ±cƒ± Y√∂netimi': true
        }
      }
    };

    // T√ºm izin tipleri (buyer ve supplier i√ßin birle≈üik liste) - Teklifbul Rule v1.0
    const allPermissionTypes = [
      // Buyer permissions
      'Talep Olu≈üturma',
      'Talep D√ºzenleme',
      'Talep Silme',
      'Teklif G√∂r√ºnt√ºleme',
      'Teklif Onaylama',
      // Supplier permissions
      'Teklif Verme',
      'Teklif D√ºzenleme',
      'Teklif Silme',
      'Talep G√∂r√ºnt√ºleme',
      'Talep Detay G√∂r√ºnt√ºleme',
      // Common permissions
      '≈ûirket Bilgileri D√ºzenleme',
      'Kullanƒ±cƒ± Y√∂netimi'
    ];
    
    // Buyer i√ßin ge√ßerli izin tipleri
    const buyerPermissionTypes = [
      'Talep Olu≈üturma',
      'Talep D√ºzenleme',
      'Talep Silme',
      'Teklif G√∂r√ºnt√ºleme',
      'Teklif Onaylama',
      '≈ûirket Bilgileri D√ºzenleme',
      'Kullanƒ±cƒ± Y√∂netimi'
    ];
    
    // Supplier i√ßin ge√ßerli izin tipleri
    const supplierPermissionTypes = [
      'Teklif Verme',
      'Teklif D√ºzenleme',
      'Teklif Silme',
      'Talep G√∂r√ºnt√ºleme',
      'Talep Detay G√∂r√ºnt√ºleme',
      '≈ûirket Bilgileri D√ºzenleme',
      'Kullanƒ±cƒ± Y√∂netimi'
    ];

    let editingRole = null;
    let originalPermissions = null;

    // Rol kartƒ± olu≈ütur - Teklifbul Rule v1.0
    function createRoleCard(roleKey, roleData, isBuyer) {
      const container = isBuyer ? document.getElementById('buyerRolesContainer') : document.getElementById('supplierRolesContainer');
      const card = document.createElement('div');
      card.className = 'role-card';
      card.id = `roleCard_${roleKey.replace(/:/g, '_')}`;

      const permissionsHtml = Object.entries(roleData.permissions).map(([perm, hasAccess]) => `
        <tr>
          <td>${perm}</td>
          <td style="text-align:center;">
            <span class="permission-status ${hasAccess ? 'permission-yes' : 'permission-no'}">
              ${hasAccess ? '‚úÖ Var' : '‚ùå Yok'}
            </span>
          </td>
        </tr>
      `).join('');

      card.innerHTML = `
        <div class="role-header">
          <div>
            <div class="role-name">${roleData.label}</div>
            <div class="role-key">${roleKey}</div>
          </div>
          <button class="edit-btn" onclick="editRole('${roleKey}')">‚úèÔ∏è D√ºzenle</button>
        </div>
        <table class="permissions-table">
          <thead>
            <tr>
              <th>Yetki</th>
              <th style="text-align:center; width:120px;">Durum</th>
            </tr>
          </thead>
          <tbody>
            ${permissionsHtml}
          </tbody>
        </table>
      `;

      container.appendChild(card);
    }

    // D√ºzenleme modu - Teklifbul Rule v1.0
    window.editRole = function(roleKey) {
      if (editingRole && editingRole !== roleKey) {
        if (!confirm('Ba≈üka bir rol√º d√ºzenliyorsunuz. Deƒüi≈üiklikleri kaydetmeden devam edilsin mi?')) {
          return;
        }
        cancelEdit();
      }

      editingRole = roleKey;
      const roleData = rolePermissions[roleKey];
      originalPermissions = JSON.parse(JSON.stringify(roleData.permissions));

      const card = document.getElementById(`roleCard_${roleKey.replace(/:/g, '_')}`);
      const permissions = roleData.permissions;

      // Bu rol i√ßin ge√ßerli olan izin tipleri - Teklifbul Rule v1.0
      const relevantPermissions = roleKey.includes('buyer') 
        ? buyerPermissionTypes 
        : supplierPermissionTypes;

      const editPermissionsHtml = relevantPermissions.map(perm => {
        const currentValue = permissions[perm] !== undefined ? permissions[perm] : false;
        return `
          <tr>
            <td>${perm}</td>
            <td style="text-align:center;">
              <input type="checkbox" class="checkbox" data-perm="${perm}" ${currentValue ? 'checked' : ''}>
            </td>
          </tr>
        `;
      }).join('');

      card.innerHTML = `
        <div class="role-header">
          <div>
            <div class="role-name">${roleData.label}</div>
            <div class="role-key">${roleKey}</div>
          </div>
          <div>
            <button class="save-btn" onclick="saveRole('${roleKey}')">üíæ Kaydet</button>
            <button class="cancel-btn" onclick="cancelEdit()">‚ùå ƒ∞ptal</button>
          </div>
        </div>
        <table class="permissions-table">
          <thead>
            <tr>
              <th>Yetki</th>
              <th style="text-align:center; width:120px;">Durum</th>
            </tr>
          </thead>
          <tbody>
            ${editPermissionsHtml}
          </tbody>
        </table>
      `;
    };

    // Kaydet - Teklifbul Rule v1.0
    window.saveRole = function(roleKey) {
      const card = document.getElementById(`roleCard_${roleKey.replace(/:/g, '_')}`);
      const checkboxes = card.querySelectorAll('.checkbox');
      const updatedPermissions = {};

      checkboxes.forEach(checkbox => {
        const perm = checkbox.getAttribute('data-perm');
        updatedPermissions[perm] = checkbox.checked;
      });

      // Orijinal permissions'ƒ± koru (bu rol i√ßin ge√ßerli olmayan izinler)
      const roleData = rolePermissions[roleKey];
      Object.keys(roleData.permissions).forEach(perm => {
        if (!updatedPermissions.hasOwnProperty(perm)) {
          updatedPermissions[perm] = roleData.permissions[perm];
        }
      });

      // G√ºncelle
      rolePermissions[roleKey].permissions = updatedPermissions;

      // Konsola yazdƒ±r (settings.html'e kopyalanacak)
      logger.info(`\n// ${rolePermissions[roleKey].label} - ${roleKey}`);
      logger.info(`'${roleKey}': {`);
      Object.entries(updatedPermissions).forEach(([perm, hasAccess]) => {
        logger.info(`  '${perm}': ${hasAccess},`);
      });
      logger.info('},');

      // Kartƒ± yeniden olu≈ütur
      createRoleCard(roleKey, rolePermissions[roleKey], roleKey.includes('buyer'));
      editingRole = null;
      originalPermissions = null;

      toast.success(MESSAGES.SUCCESS_ROLE_PERMISSIONS_UPDATED);
    };

    // ƒ∞ptal - Teklifbul Rule v1.0
    window.cancelEdit = function() {
      if (!editingRole) return;

      const roleKey = editingRole;
      const roleData = rolePermissions[roleKey];
      
      // Orijinal permissions'ƒ± geri y√ºkle
      roleData.permissions = originalPermissions;

      // Kartƒ± yeniden olu≈ütur
      const card = document.getElementById(`roleCard_${roleKey.replace(/:/g, '_')}`);
      card.remove();
      createRoleCard(roleKey, roleData, roleKey.includes('buyer'));

      editingRole = null;
      originalPermissions = null;
    };

    // Sayfa y√ºklendiƒüinde t√ºm rolleri g√∂ster - Teklifbul Rule v1.0
    document.addEventListener('DOMContentLoaded', () => {
      Object.entries(rolePermissions).forEach(([roleKey, roleData]) => {
        const isBuyer = roleKey.includes('buyer');
        createRoleCard(roleKey, roleData, isBuyer);
      });
    });
  </script>
</body>
</html>

